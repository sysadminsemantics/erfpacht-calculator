# .copilot-instructions.md
## Project: “Erfpacht Den Haag — Simpele Calculator” (AB1986 vs AB2024)

In deze git-repo `erfpacht-calcualtor`ga je onderstaand bouwen.

### Doel
Bouw een **erg simpele**, maar **visueel sterke** web-app (geen login) die inwoners van **Den Haag** helpt om hun erfpacht-situatie te begrijpen en scenario’s te vergelijken:
1) **Doorgaan met canonbetaling** (AB1986 of AB2024)  
2) **Vrijwillig overstappen** van AB1986 naar **AB2024** (als scenario)  
3) **Eeuwigdurend afkopen van canon** (als scenario)  
4) **(Waar mogelijk) van erfpacht naar eigen grond** via “bloot eigendom” (als scenario)  
5) **Belastingeffect** tonen: aftrekbaarheid van periodieke canon (box 1) + uitleg dat afkoopbedrag zelf niet aftrekbaar is, maar rente op lening vaak wel.

De output moet vooral **begrijpelijk, transparant en “indicatief”** zijn (met duidelijke aannames), en de UI moet “premium” aanvoelen.

---

## Tech keuzes (kies dit tenzij je een betere reden hebt)
- **Next.js (App Router) + TypeScript**
- **Tailwind + shadcn/ui** voor componenten (Cards, Tabs, Slider, Inputs)
- **Recharts** voor grafieken (cumulatieve kosten, jaarlijkse kosten, NPV)
- Geen backend nodig. Alles client-side.
- Opslag: LocalStorage (laatste ingevulde waarden bewaren).
- Toegankelijkheid: keyboard navigatie, duidelijke contrasten, aria-labels.

---

## UX/IA (informatiearchitectuur)
### Pagina’s / flows
**1) Home**
- Hero + korte uitleg “Wat is erfpacht in Den Haag?”
- Call-to-action: “Start berekening”
- Korte disclaimer: “indicatieve tool; check altijd akte/aanbod gemeente”

**2) Wizard (stapsgewijs, met progress bar)**
Stap A — Contract
- Keuze: “Mijn recht valt onder”:
  - AB 1986 (en ouder contract dat er praktisch onder valt)
  - AB 2024 (nieuwe uitgiftes vanaf 24 dec 2024; of na overstap)
  - “Weet ik niet” (toon hulpmodule: waar vind je dit in je akte)
- Optioneel: “Canon wordt herzien (typisch 5-jaarlijks)” toggle + veld “volgende herzieningsjaar”
- Looptijd: “eeuwigdurend / aflopend (met einddatum) / onbekend”

Stap B — Waarden
- Invoer: “Grondwaarde (uit akte / taxatie)”
- Invoer: “WOZ-waarde (optioneel; voor ‘eigen grond’-scenario)”
- Jaar van uitgifte / heruitgifte (optioneel, voor context)

Stap C — Betaling nu
- Invoer: huidige jaarlijkse canon (optioneel, om te “sanity checken”)
- Beheerkosten (default: laat gebruiker invullen of neem een klein default en label als “schatting”)

Stap D — Belasting & financiering
- Toggle: “Dit is mijn eigen woning (box 1)”
- Invoer: marginale belastingdruk (schuif: 30%–55%, default 37%)
- Toggle: “Afkoop/koop financieren met lening?”
  - zo ja: rente% en looptijd (voor indicatieve rentekosten en belastingeffect)
- Tooltip: periodieke canon is aftrekbaar; afkoopsom niet; rente op lening meestal wel (met link naar bronnen).

**3) Resultaten dashboard**
- Bovenaan: 3–4 grote “Summary cards”:
  - Jaarlijkse netto last (na belasting) — huidig scenario
  - Scenario AB2024 (indien relevant) — verschil per jaar
  - Break-even jaar (afkoop of koop vs blijven betalen)
  - NPV-verschil (met gekozen discontovoet)
- Tabs:
  - “Overzicht”
  - “Scenario’s vergelijken”
  - “Aannames & bronnen”
- Grafieken:
  - Jaarlijkse kosten (bruto en netto)
  - Cumulatieve kosten over 30 jaar
  - NPV per scenario (bar chart)
- Export (nice-to-have): “Download PDF-samenvatting” (mag client-side, basic)

---

## Den Haag-specifieke rekenregels die je moet implementeren (indicatief, transparant)
### 1) Canonberekening (basis)
Gebruik als basisformule:
- **Jaarlijkse canon (bruto) = grondwaarde × canonpercentage + beheerkosten**

Onder AB1986:
- canonpercentage wordt jaarlijks vastgesteld; de gemeente gebruikt (contractueel) het gemiddelde van 2 rentes (BNG-lening en hypotheekrente). (Bron in “About”).  
- In de app hoef je niet live rentes te scrapen: gebruik **door de gemeente gepubliceerde canonpercentages** als input-parameter per jaar.

Onder AB2024:
- canonpercentage wordt bepaald via **tienjaarsgemiddelde** (dempt schokken).  
- Toon verschil tussen AB1986 en AB2024 op basis van officiële percentages voor recente jaren.

### 2) Gebruik officiële canonpercentages als default dataset
Maak een constants bestand (bijv. `data/denhaag-canonpercentages.ts`) met:
- AB1986 canonpercentage voor 2026: **3,3%**
- AB2024 canonpercentages: **2023 1,9%**, **2024 2,0%**, **2025 2,1%**, **2026 2,2%**
Label dit als “bron: gemeente Den Haag / RIS”.

UI: laat gebruiker “jaar” kiezen (default huidig jaar) en toon de bijbehorende percentages.
Als gebruiker een ander jaar wil rekenen dat niet in dataset staat: laat ze het percentage handmatig invullen (met waarschuwing).

### 3) Scenario: overstappen AB1986 → AB2024
Als contract = AB1986:
- Toon scenario “Overstappen naar AB2024” (als reken-scenario).
- Bereken besparing: canonpercentage AB1986 minus AB2024, toegepast op grondwaarde.
- Let op: in werkelijkheid kunnen voorwaarden/administratie gelden; in de app is dit “indicatief”.

### 4) Scenario: afkoop canon (eeuwigdurend)
- Toon als een “eenmalige” betaling die daarna jaarlijkse canon = 0 (beheerkosten kunnen blijven bestaan afhankelijk van praktijk; bied toggle).
- Belasting:
  - **Afkoopsom zelf niet aftrekbaar.**
  - Als gebruiker financiert met lening: rente op lening **vaak** aftrekbaar (toon als indicatie).
- Voor de **afkoopsom**: dit is contract- en aanbod-afhankelijk. Implementatie:
  - Vraag gebruiker om het afkoopbedrag als input, óf
  - Bied een “ruwe schatting” modus: NPV van toekomstige canon over N jaar (default 30) met discontovoet (default 3%–4% slider).
  - Label de schatting duidelijk: “Gemeente-aanbod kan afwijken; gebruik dit voor ordegrootte.”

### 5) Scenario: van erfpacht naar eigen grond (bloot eigendom)
- Dit is niet altijd mogelijk; zet daarom een eligibility module:
  - “Mijn wijk/perceel staat dit toe” (toggle: ja/nee/weet ik niet)
  - Toon waarschuwing dat bestemmingsplan/beleid bepalend kan zijn.
- Implementatie basisbedrag (WOZ-staffel) zoals op Den Haag pagina:
  - 0–200k: 700
  - 200–300k: 1.205
  - 300–400k: 1.650
  - 400–500k: 2.350
  - 500–700k: 2.790
  - 700k–1.000.000: 4.315
  - 1.000.000+: 6.980
- Voeg een veld toe “extra bedrag i.v.m. extra bouw-/gebruiksmogelijkheden” (optioneel), want de gemeente kan bovenop het vaste bedrag iets rekenen.
- Netto: aankoop eigen grond is géén periodieke canon meer, maar hypotheek-/leningrente kan wel relevant zijn (als gebruiker financiert).

### 6) Grondwaarde / taxatie context (uitleg, geen harde berekening)
- Voeg een “Info card” toe over grondwaarde:
  - grondwaarde wordt bepaald via taxatie en kan bij heruitgifte begrensd zijn (bijv. 55% cap in bepaalde context).  
- Niet proberen om grondwaarde volledig te herleiden uit WOZ zonder officiële methodiek: bied hoogstens een “schatting” met duidelijke waarschuwing.

---

## Belastingmodule (indicatief)
- Alleen als gebruiker aanvinkt “Eigen woning (box 1)”.
- Jaarlijkse aftrekbare kosten:
  - **Periodieke canonbetalingen** (aftrekbaar)
  - Afkoopbedrag: **niet aftrekbaar**
  - Rente op lening voor afkoop/koop: vaak aftrekbaar (toon als “meestal” + bronlink)
- Rekenen:
  - Netto canon = bruto canon × (1 - marginale belastingdruk)
  - Netto rente = rente × (1 - marginale belastingdruk) (alleen als gebruiker dit aanzet)
- Toon heel duidelijk: “Dit is een versimpeling. Voor exact advies: Belastingdienst/adviseur.”

---

## Berekenkern (engineering)
- Zet alle rekenlogica in pure functies:
  - `calcAnnualCanon({groundValue, canonRate, managementFee})`
  - `calcTaxBenefit({deductibleAmount, marginalRate})`
  - `calcNPV({cashflows, discountRate})`
  - `buildScenarioCashflows({years, ...inputs})`
- Houd scenario’s als data-structuur:
  - id, label, assumptions, cashflows[], npv, breakEvenYear
- Maak tests voor de kernfuncties (vitest/jest):
  - canonberekening klopt
  - belasting netto = bruto*(1-rate)
  - NPV monotoniciteit sanity check

---

## Visual design requirements
- Clean, modern, “Apple-ish” maar warm:
  - veel whitespace
  - grote headings, rustige body text
  - kaarten met subtiele schaduw
  - iconen (lucide-react)
- Microcopy in helder Nederlands, niet juridisch
- Tooltips en “Waarom vragen we dit?” links
- Dark mode optional (nice-to-have)

---

## “Aannames & Bronnen” pagina (must-have)
Maak een tab “Aannames & Bronnen” waarin staat:
- welke canonpercentages zijn ingebouwd
- wat AB1986 vs AB2024 grofweg betekent (in 3 bullets)
- fiscale regels in 3 bullets (periodiek wel, afkoop niet, rente vaak wel)
- links naar de belangrijkste bronnen (gemeente Den Haag + Belastingdienst + AB-teksten)
Let op: geen lange quotes, alleen korte samenvatting en verwijzing.

---

## Niet doen
- Geen login, geen accounts, geen backend database
- Geen “exacte gemeentelijke offerte” claimen
- Geen scraping van live rentepercentages als harde waarheid
- Geen agressieve “koop nu” aanbevelingen; alleen transparante vergelijking

---

## Definition of Done
- Werkende wizard + resultaten dashboard
- Scenario’s: AB1986, AB2024 (en overstap), Afkoop canon (input + NPV schatting), Eigen grond (WOZ staffel)
- Netto/bruto + belastingmodule
- Grafieken + break-even + NPV
- Bronnen-tab aanwezig
- Mobile friendly (minimaal goed bruikbaar op telefoon)

